<?PHp
										define(TABLA_POS_ITEMS,'pos_items');
										define(TABLA_POS_ITEMS_SALES,'pos_sales');
										define(TABLA_POS_ITEMS_SALES_ITEMS,'pos_sales_items');



class sincronizar
{


public function sincronizar_ventras_standby($a_request)
	{

						#----------------------------------------------------------------------------------------
						#	PRIMERO OBTENGO LA INFOMACION DE LOS PRODUCTOS
							$a_sql['datos']			='	
														*
													';
							$a_sql['tabla']			=TABLA_POS_ITEMS_SALES;
							$a_sql['donde']			=' 
														status=1
														AND status_envio=0
														
													';
							//echo $info_pos_items[0]['pos_item_id'];
							$a_venta				    =Fjvm_consulta::query_consulta($a_sql,'');#ver_consulta
						 	$total_venta 			=count($a_venta);
						#----------------------------------------------------------------------------------------	

						$a_mess[$b=0]		='<br>**-> '.date('H:i:s').' = <strong>Total Ventas a Sincronizar: </strong>  '.$total_venta.' Ventas';

							for ($i=0; $i < $total_venta ; $i++) { 
								
								$a_cab 			=$a_venta[$i];
								$v_sale_id		=$a_venta[$i]['id'];
								$v_sale_ticket	=$a_venta[$i]['invoicenumber'];

												#----------------------------------------------------------------------------------------
												#	OBTENGO EL DETALLE
													$a_detalle 	=sincronizar::detalle_venta($v_sale_id);
												#----------------------------------------------------------------------------------------


															$campos1= json_encode($a_cab);
															$campos2= json_encode($a_detalle);

									ws_sinronizar_all::enviar_ticket_venta(
																							$v_sale_id,
																							$cedula 		='',
																							$formula_numero ='',
																							$campos1,
																							$campos2
																			);
						$a_mess[++$b]		='<br>******-> '.date('H:i:s').' = <strong>Sincronizado El Ticket : </strong>  '.$v_sale_ticket.' Ventas';


							}

						$a_mess[++$b]		='<br>**-> '.date('H:i:s').' = <strong>Sincronizado un total de : </strong>  '.$i.' Ventas';
						$a_mess[++$b]		='<br>**-> '.date('H:i:s').' = <strong>::::::::::::::::::::::::::::::::::::::::::::::::::::::: FIN DEL PROCESO </strong> ';
			
			return $a_mess;

	}

/*
#################################################################################################
##########################################################---------------------------------########
########################################################-----------------------------------########
#####################################################--------------------------------------########
#################################################------------------------------------------########
##############################################---------------------------------------------########
###########################################------------------------------------------------########
#######################################----------------------------------------------------########
###################################--------------------------------------------------------########
######################################-----------------------------------------------------########
###########################################------------------------------------------------########
##############################################---------------------------------------------########
#################################################------------------------------------------########
####################################################---------------------------------------########
###################################################################################################
*/  

public function detalle_venta($venta_id)
	{


						#----------------------------------------------------------------------------------------
						#	PRIMERO OBTENGO LA INFOMACION DE LOS PRODUCTOS
							$a_sql['datos']			='	
														*
													';
							$a_sql['tabla']			=TABLA_POS_ITEMS_SALES_ITEMS;
							$a_sql['donde']			=' 
														sale_id="'.$venta_id.'"
													';
							//echo $info_pos_items[0]['pos_item_id'];
							return 					Fjvm_consulta::query_consulta($a_sql,'');#ver_consulta


	}





/*
#################################################################################################
##########################################################---------------------------------########
########################################################-----------------------------------########
#####################################################--------------------------------------########
#################################################------------------------------------------########
##############################################---------------------------------------------########
###########################################------------------------------------------------########
#######################################----------------------------------------------------########
###################################--------------------------------------------------------########
######################################-----------------------------------------------------########
###########################################------------------------------------------------########
##############################################---------------------------------------------########
#################################################------------------------------------------########
####################################################---------------------------------------########
###################################################################################################
*/  

public function sincronizar_hora($arreglo)
	{
		global $cliente;
	
				#----------------------------------------------------------------------------------------
				#	ARCHIVO DE LA DIRECCION IP DE LOS WSDL
							include('ws_productos.wsc.php');
				#----------------------------------------------------------------------------------------	

		ws_productos::incluirClases();
		ws_productos::conectarWebService(URL_WEB_SERVICE_SERVIDOR);

		$arreglo['acceso']=ws_productos::clave();




		$a_producto 	= $cliente->call(
											'enviarOnlinePos'
											,array('parametro'=>$arreglo)
										);
		$mess			='enviarOnline';
		ws_productos::verificarError($mess);


		return $a_producto;

	}
}#class reporte























